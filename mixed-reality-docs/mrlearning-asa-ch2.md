---
title: Esercitazioni sugli ancoraggi spaziali di Azure-2. Salvataggio, recupero e condivisione di ancoraggi spaziali di Azure
description: Completa questo corso per informazioni su come implementare il riconoscimento volto di Azure in un'applicazione di realtà mista.
author: jessemcculloch
ms.author: jemccull
ms.date: 02/26/2019
ms.topic: article
keywords: realtà mista, unity, esercitazione, hololens
ms.openlocfilehash: 7b19233a9634e2568200476c9483464bbf9dd3c8
ms.sourcegitcommit: a580166a19294f835b8e09c780f663f228dd5de0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/14/2020
ms.locfileid: "77250741"
---
# <a name="2-saving-retrieving-and-sharing-azure-spatial-anchors"></a><span data-ttu-id="d4e2d-105">2. salvataggio, recupero e condivisione di ancoraggi spaziali di Azure</span><span class="sxs-lookup"><span data-stu-id="d4e2d-105">2. Saving, retrieving, and sharing Azure Spatial Anchors</span></span>

<span data-ttu-id="d4e2d-106">In questa esercitazione si apprenderà come salvare gli ancoraggi spaziali di Azure tra più sessioni dell'app salvando l'ID di ancoraggio nell'archivio di HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-106">In this tutorial, you will learn how to save Azure Spatial Anchors across multiple app sessions by saving the anchor ID to the HoloLens 2's storage.</span></span> <span data-ttu-id="d4e2d-107">Si apprenderà anche come condividere questo ID di ancoraggio ad altri dispositivi per un allineamento di ancoraggio a più dispositivi.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-107">You will also learn how to share this anchor ID to other devices for a multi-device anchor alignment.</span></span>

## <a name="objectives"></a><span data-ttu-id="d4e2d-108">Obiettivi</span><span class="sxs-lookup"><span data-stu-id="d4e2d-108">Objectives</span></span>

* <span data-ttu-id="d4e2d-109">Informazioni su come salvare e recuperare gli ID di ancoraggio spaziale di Azure da e verso il disco locale HoloLens 2, per la persistenza tra le sessioni dell'app</span><span class="sxs-lookup"><span data-stu-id="d4e2d-109">Learn how to save and retrieve Azure Spatial Anchor IDs to and from the HoloLens 2 local disk, for persistence between app sessions</span></span>
* <span data-ttu-id="d4e2d-110">Informazioni su come condividere gli ID di ancoraggio spaziali di Azure tra gli utenti in uno scenario con più dispositivi</span><span class="sxs-lookup"><span data-stu-id="d4e2d-110">Learn how to share Azure Spatial Anchor IDs between users in a multi-device scenario</span></span>

## <a name="preparing-the-scene"></a><span data-ttu-id="d4e2d-111">Preparazione della scena</span><span class="sxs-lookup"><span data-stu-id="d4e2d-111">Preparing the scene</span></span>

<span data-ttu-id="d4e2d-112">Nella finestra del progetto passare a **assets** > **MRTK. Tutorials. AzureSpatialAnchors** > cartella **prefabbricates** .</span><span class="sxs-lookup"><span data-stu-id="d4e2d-112">In the Project window, navigate to **Assets** > **MRTK.Tutorials.AzureSpatialAnchors** > **Prefabs** folder.</span></span> <span data-ttu-id="d4e2d-113">Tenendo premuto il pulsante CTRL, fare clic su **ButtonParent_SaveAnchorId** e **ButtonParent_ShareAnchorId** per selezionare i due prefissi, quindi trascinarli nella finestra della gerarchia per aggiungerli alla scena:</span><span class="sxs-lookup"><span data-stu-id="d4e2d-113">While holding down the CTRL button, click on **ButtonParent_SaveAnchorId** and **ButtonParent_ShareAnchorId** to select the two prefabs, then drag them into the Hierarchy window to add them to the scene:</span></span>

![mrlearning-ASA](images/mrlearning-asa/tutorial2-section1-step1-1.png)

## <a name="persist-azure-anchors-between-app-sessions---save-anchor-id-to-disk"></a><span data-ttu-id="d4e2d-115">Mantieni gli ancoraggi di Azure tra le sessioni dell'app-salva l'ID ancoraggio sul disco</span><span class="sxs-lookup"><span data-stu-id="d4e2d-115">Persist Azure Anchors between app sessions - Save anchor ID to disk</span></span>
<!-- TODO: Consider renaming to 'Persist Azure Anchors between app sessions' -->

<span data-ttu-id="d4e2d-116">In questa sezione si apprenderà come salvare e recuperare l'ID di ancoraggio di Azure da e verso il disco locale HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-116">In this section, you will learn how to save and retrieve the Azure Anchor ID to and from the HoloLens 2 local disk.</span></span> <span data-ttu-id="d4e2d-117">In questo modo sarà possibile eseguire query in Azure per lo stesso ID di ancoraggio tra diverse sessioni dell'app, consentendo agli ologrammi ancorati di essere posizionati nella stessa posizione della sessione dell'app precedente.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-117">This will allow you to query Azure for the same anchor ID between different app sessions, allowing the anchored holograms to be position at the same location as in the previous app session.</span></span>

<span data-ttu-id="d4e2d-118">Nella finestra gerarchia espandere l'oggetto **ButtonParent_SaveAnchorId** contenente due pulsanti, un pulsante per il salvataggio dell'ID di ancoraggio di Azure nell'archiviazione HoloLens 2 e un altro per il recupero dell'ID salvato dal disco:</span><span class="sxs-lookup"><span data-stu-id="d4e2d-118">In the Hierarchy window, expand the **ButtonParent_SaveAnchorId** object which contains two buttons, one button for saving the Azure Anchor ID to the HoloLens 2 storage and another for retrieving the saved ID from the disk:</span></span>

![mrlearning-ASA](images/mrlearning-asa/tutorial2-section2-step1-1.png)

<span data-ttu-id="d4e2d-120">Seguire la stessa procedura illustrata nella sezione [configurazione dei pulsanti per usare le](mrlearning-asa-ch1.md#configuring-the-buttons-to-operate-the-scene) istruzioni della scena dell'esercitazione precedente per configurare il componente di controllo di **Holo Lens 2 (script)** e il componente **interactable (script)** in ognuno dei due pulsanti:</span><span class="sxs-lookup"><span data-stu-id="d4e2d-120">Follow the same steps as in the [configuring the buttons to operate the scene](mrlearning-asa-ch1.md#configuring-the-buttons-to-operate-the-scene) instructions from the previous tutorial to configure the **Pressable Button Holo Lens 2 (Script)** component and the **Interactable (Script)** component on each of the two buttons:</span></span>

* <span data-ttu-id="d4e2d-121">Per l'oggetto **SaveAzureAnchorIdToDisk** , assegnare la funzione AnchorModuleScript > **SaveAzureAnchorIdToDisk ()** .</span><span class="sxs-lookup"><span data-stu-id="d4e2d-121">For the **SaveAzureAnchorIdToDisk** object, assign the AnchorModuleScript > **SaveAzureAnchorIdToDisk ()** function.</span></span>
* <span data-ttu-id="d4e2d-122">Per l'oggetto **GetAzureAnchorIdFromDisk** , assegnare la funzione AnchorModuleScript > **GetAzureAnchorIdFromDisk ()** .</span><span class="sxs-lookup"><span data-stu-id="d4e2d-122">For the **GetAzureAnchorIdFromDisk** object, assign the AnchorModuleScript > **GetAzureAnchorIdFromDisk ()** function.</span></span>

<span data-ttu-id="d4e2d-123">Se si compila l'applicazione aggiornata in HoloLens, è ora possibile salvare in modo permanente gli ancoraggi spaziali di Azure tra le sessioni dell'app salvando l'ID di ancoraggio di Azure.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-123">If you build the updated application to your HoloLens, you can now persist Azure Spatial Anchors between app sessions by saving the Azure Anchor ID.</span></span> <span data-ttu-id="d4e2d-124">Per eseguire il test, è possibile seguire questa procedura:</span><span class="sxs-lookup"><span data-stu-id="d4e2d-124">To test it out, you can follow these steps:</span></span>

1. <span data-ttu-id="d4e2d-125">Spostare l'esperienza di avvio del Rocket nella posizione desiderata.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-125">Move the Rocket Launcher experience to desired location.</span></span>
2. <span data-ttu-id="d4e2d-126">Avviare la sessione di Azure.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-126">Start Azure Session.</span></span>
3. <span data-ttu-id="d4e2d-127">Creare Anchor di Azure (crea ancoraggi in corrispondenza della posizione dell'esperienza di avvio Rocket).</span><span class="sxs-lookup"><span data-stu-id="d4e2d-127">Create Azure Anchor (creates anchors at the location of the Rocket Launcher experience).</span></span>
4. <span data-ttu-id="d4e2d-128">Salvare l'ID ancoraggio di Azure su disco.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-128">Save Azure Anchor ID to Disk.</span></span>
5. <span data-ttu-id="d4e2d-129">Riavviare l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-129">Restart the application.</span></span>
6. <span data-ttu-id="d4e2d-130">Ottenere Azure Anchor dal disco (carica l'ID di ancoraggio appena salvato).</span><span class="sxs-lookup"><span data-stu-id="d4e2d-130">Get Azure Anchor from Disk (loads the anchor ID you just saved).</span></span>
7. <span data-ttu-id="d4e2d-131">Avviare la sessione di Azure.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-131">Start Azure Session.</span></span>
8. <span data-ttu-id="d4e2d-132">Trovare l'ancoraggio di Azure (posiziona l'esperienza di avvio Rocket nella posizione del passaggio 3).</span><span class="sxs-lookup"><span data-stu-id="d4e2d-132">Find Azure Anchor (positions the Rocket Launcher experience at the location from step 3).</span></span>

## <a name="share-azure-anchors-between-multiple-devices"></a><span data-ttu-id="d4e2d-133">Condividere gli ancoraggi di Azure tra più dispositivi</span><span class="sxs-lookup"><span data-stu-id="d4e2d-133">Share Azure Anchors between multiple devices</span></span>

<span data-ttu-id="d4e2d-134">In questa sezione si apprenderà come condividere l'ID ancoraggio di Azure tra più dispositivi.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-134">In this section, you will learn how to share the Azure Anchor ID between multiple devices.</span></span> <span data-ttu-id="d4e2d-135">Questo consentirà a più dispositivi di eseguire query su Azure per lo stesso ID ancoraggio, consentendo agli ologrammi ancorati di essere allineati dal punto di vista spaziale.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-135">This will allow multiple devices to query Azure for the same anchor ID, allowing the anchored holograms to be spatially aligned.</span></span> <span data-ttu-id="d4e2d-136">L'allineamento spaziale, ovvero la visualizzazione degli stessi ologrammi nella stessa posizione fisica tra più dispositivi, è fondamentale per le esperienze condivise locali in HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-136">Spatial alignment, i.e. seeing the same holograms in the same physical location between multiple devices, is key to local shared experiences in the HoloLens 2.</span></span>

<span data-ttu-id="d4e2d-137">Esistono diversi modi per trasferire gli ID di ancoraggio di Azure tra i dispositivi, inclusi i metodi descritti nella serie di [esercitazioni sulle funzionalità multiutente](mrlearning-sharing(photon)-ch1.md) .</span><span class="sxs-lookup"><span data-stu-id="d4e2d-137">There are many ways to transfer Azure Anchor IDs between devices, including methods outlined in the the [Multi-user capabilities tutorials](mrlearning-sharing(photon)-ch1.md) series.</span></span> <span data-ttu-id="d4e2d-138">In questo esempio si userà un semplice servizio Web per caricare e scaricare gli ID di ancoraggio tra i dispositivi.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-138">In this example, you will use a simple web service to upload and download anchor IDs between devices.</span></span>

<span data-ttu-id="d4e2d-139">Nella finestra gerarchia espandere l'oggetto **ButtonParent_ShareAnchorId** contenente due pulsanti; un pulsante per caricare l'ID di ancoraggio di Azure nel server Web e un altro per scaricare l'ID dal server Web:</span><span class="sxs-lookup"><span data-stu-id="d4e2d-139">In the Hierarchy window, expand the **ButtonParent_ShareAnchorId** object which contains two buttons; one button for uploading the Azure Anchor ID to the web server, and another for downloading the ID from the web server:</span></span>

![mrlearning-ASA](images/mrlearning-asa/tutorial2-section3-step1-1.png)

<span data-ttu-id="d4e2d-141">Seguire la stessa procedura illustrata nella sezione [configurazione dei pulsanti per usare le](mrlearning-asa-ch1.md#configuring-the-buttons-to-operate-the-scene) istruzioni della scena dell'esercitazione precedente per configurare il componente di controllo di **Holo Lens 2 (script)** e il componente **interactable (script)** in ognuno dei due pulsanti:</span><span class="sxs-lookup"><span data-stu-id="d4e2d-141">Follow the same steps as in the [configuring the buttons to operate the scene](mrlearning-asa-ch1.md#configuring-the-buttons-to-operate-the-scene) instructions from the previous tutorial to configure the **Pressable Button Holo Lens 2 (Script)** component and the **Interactable (Script)** component on each of the two buttons:</span></span>

* <span data-ttu-id="d4e2d-142">Per l'oggetto **ShareAzureAnchorIdToNetwork** , assegnare la funzione AnchorModuleScript > **ShareAzureAnchorIdToNetwork ()** .</span><span class="sxs-lookup"><span data-stu-id="d4e2d-142">For the **ShareAzureAnchorIdToNetwork** object, assign the AnchorModuleScript > **ShareAzureAnchorIdToNetwork ()** function.</span></span>
* <span data-ttu-id="d4e2d-143">Per l'oggetto **GetAzureAnchorIdFromNetwork** , assegnare la funzione AnchorModuleScript > **GetAzureAnchorIdFromNetwork ()** .</span><span class="sxs-lookup"><span data-stu-id="d4e2d-143">For the **GetAzureAnchorIdFromNetwork** object, assign the AnchorModuleScript > **GetAzureAnchorIdFromNetwork ()** function.</span></span>

<span data-ttu-id="d4e2d-144">Se si compila l'applicazione aggiornata in due dispositivi HoloLens, è ora possibile ottenere l'allineamento spaziale tra di essi condividendo l'ID ancoraggio di Azure.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-144">If you build the updated application to two HoloLens devices, you can now achieve spatial alignment between them by sharing the Azure Anchor ID.</span></span> <span data-ttu-id="d4e2d-145">Per eseguire il test, è possibile seguire questa procedura:</span><span class="sxs-lookup"><span data-stu-id="d4e2d-145">To test it out, you can follow these steps:</span></span>

1. <span data-ttu-id="d4e2d-146">Sul dispositivo HoloLens 1: spostare l'esperienza dell'utilità di avvio Rocket nella posizione desiderata.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-146">On HoloLens device 1: Move the Rocket Launcher experience to desired location.</span></span>
2. <span data-ttu-id="d4e2d-147">Sul dispositivo HoloLens 1: avviare la sessione di Azure.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-147">On HoloLens device 1: Start Azure Session.</span></span>
3. <span data-ttu-id="d4e2d-148">In HoloLens Device 1: create Azure Anchor (crea ancoraggi in corrispondenza della posizione dell'esperienza di avvio di Rocket).</span><span class="sxs-lookup"><span data-stu-id="d4e2d-148">On HoloLens device 1: Create Azure Anchor (creates anchors at the location of the Rocket Launcher experience).</span></span>
4. <span data-ttu-id="d4e2d-149">Sul dispositivo HoloLens 1: condividere l'ID ancoraggio di Azure con la rete.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-149">On HoloLens device 1: Share Azure Anchor ID to Network.</span></span>
5. <span data-ttu-id="d4e2d-150">Sul dispositivo HoloLens 2: riavviare l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-150">On HoloLens device 2: Restart the application.</span></span>
6. <span data-ttu-id="d4e2d-151">Sul dispositivo HoloLens 2: ottenere l'ID di ancoraggio condiviso dalla rete (Recupera l'ID di ancoraggio appena condiviso dal dispositivo HoloLens 1).</span><span class="sxs-lookup"><span data-stu-id="d4e2d-151">On HoloLens device 2: Get Shared Anchor ID from Network (fetches the anchor ID just shared from HoloLens device 1).</span></span>
7. <span data-ttu-id="d4e2d-152">Nel dispositivo HoloLens 2: avviare la sessione di Azure.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-152">On HoloLens device 2: Start Azure Session.</span></span>
8. <span data-ttu-id="d4e2d-153">Sul dispositivo HoloLens 2: trovare l'ancoraggio di Azure (posiziona l'esperienza di avvio Rocket in corrispondenza della posizione del passaggio 3).</span><span class="sxs-lookup"><span data-stu-id="d4e2d-153">On HoloLens device 2: Find Azure Anchor (positions the Rocket Launcher experience at the location from step 3).</span></span>

> [!TIP]
> <span data-ttu-id="d4e2d-154">Se è presente un solo HoloLens, è comunque possibile testare la funzionalità riavviando l'applicazione invece di usare un secondo dispositivo HoloLens.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-154">If you only have one HoloLens, you can still test the functionality by restarting the application instead of using a second HoloLens device.</span></span>

## <a name="congratulations"></a><span data-ttu-id="d4e2d-155">Complimenti</span><span class="sxs-lookup"><span data-stu-id="d4e2d-155">Congratulations</span></span>

<span data-ttu-id="d4e2d-156">In questa esercitazione si è appreso come salvare in modo permanente gli ancoraggi spaziali di Azure tra le sessioni dell'applicazione e i riavvii delle applicazioni salvando l'ID di ancoraggio spaziale di Azure nel disco locale in HoloLens.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-156">In this tutorial you learned how to persist Azure Spatial Anchors between application sessions and application restarts by saving the Azure Spatial Anchor ID to the local disk on HoloLens.</span></span> <span data-ttu-id="d4e2d-157">Si è anche appreso come condividere gli ancoraggi spaziali di Azure tra più dispositivi per un'esperienza condivisa di base di un ologramma statico multiutente.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-157">You also learned how to share Azure Spatial Anchors between multiple devices for a basic multi-user, static hologram shared experience.</span></span>

<span data-ttu-id="d4e2d-158">Nell'esercitazione successiva si apprenderà come fornire agli utenti il feedback in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-158">In the next tutorial you will learn how to provide users with real-time feedback.</span></span> <span data-ttu-id="d4e2d-159">Questo feedback includerà informazioni sulla creazione di ancoraggi, sulla qualità della comprensione dell'ambiente e sullo stato della sessione di Azure.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-159">This feedback will include information about Anchor creation, the quality of environment understanding, and the state of the Azure session.</span></span> <span data-ttu-id="d4e2d-160">Senza commenti, gli utenti potrebbero non sapere se un ancoraggio è stato caricato correttamente in Azure, se la qualità dell'ambiente è sufficiente per la creazione dell'ancoraggio o lo stato corrente.</span><span class="sxs-lookup"><span data-stu-id="d4e2d-160">Without feedback, users may not know whether an anchor has successfully been uploaded to Azure, whether the quality of the environment is sufficient for anchor creation, or the current state.</span></span>

[<span data-ttu-id="d4e2d-161">Lezione successiva: 3. Visualizzazione del feedback di ancoraggio spaziale di Azure</span><span class="sxs-lookup"><span data-stu-id="d4e2d-161">Next Lesson: 3. Displaying Azure Spatial Anchor feedback</span></span>](mrlearning-asa-ch3.md)
